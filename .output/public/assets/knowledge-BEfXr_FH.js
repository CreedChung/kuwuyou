import{j as e,L as j,e as L,r as i,u as K}from"./main-Cueo9Gmc.js";import{B as S}from"./button-r6mHSpo9.js";import{C as g,d as b,I as k,a as P,b as B,c as z}from"./input-DtfU5s6Y.js";import{A as E}from"./arrow-left-8OJs-tGC.js";import{B as m}from"./book-open-STSHqvFR.js";import{S as I}from"./search-c6_-r4tE.js";import{B as f}from"./badge-7Wvi9YT3.js";import{i as T,f as p,b as _,K as A}from"./KnowledgePagination-Dc82F8c5.js";import{L as D}from"./loader-circle-Cbks1rAA.js";import"./dialog-CemJiPxP.js";import"./label-CMEA9w--.js";import"./progress-DqRNMebT.js";import{P as Q}from"./ProtectedRoute-AJQc2QAr.js";import"./index-CZGrV-Ob.js";import"./react-icons.esm-Oflcc6fQ.js";import"./index-DOUzLCEu.js";function R({total:s,currentCount:t}){return e.jsxs("div",{className:"w-64 border-r border-border/40 bg-muted/30 flex flex-col",children:[e.jsx("div",{className:"p-4 border-b border-border/40",children:e.jsx(j,{href:"/chat",children:e.jsxs(S,{variant:"ghost",size:"sm",className:"w-full justify-start gap-2 hover:bg-muted",children:[e.jsx(E,{className:"h-4 w-4"}),e.jsx("span",{children:"è¿”å›ž"})]})})}),e.jsx("div",{className:"px-4 py-6",children:e.jsxs("h1",{className:"text-xl font-semibold flex items-center gap-2",children:[e.jsx(m,{className:"h-5 w-5"}),"çŸ¥è¯†åº“"]})}),e.jsx("div",{className:"px-4 pb-4",children:e.jsx(g,{className:"bg-gradient-to-br from-primary/10 via-primary/5 to-transparent border-primary/20 shadow-sm",children:e.jsx(b,{className:"p-5",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"çŸ¥è¯†åº“æ€»æ•°"}),e.jsx("p",{className:"text-3xl font-bold text-foreground",children:s})]}),e.jsx("div",{className:"h-12 w-12 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(m,{className:"h-6 w-6 text-primary"})})]}),e.jsx("div",{className:"pt-3 border-t border-border/50",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"å½“å‰æ˜¾ç¤º"}),e.jsx("span",{className:"font-semibold text-lg text-foreground",children:t})]})})]})})})}),e.jsx("div",{className:"flex-1 px-4 pb-4"})]})}function $({searchQuery:s,onSearchChange:t}){return e.jsx("div",{className:"border-b border-border/40 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"relative max-w-2xl",children:[e.jsx(I,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(k,{value:s,onChange:r=>t(r.target.value),placeholder:"æœç´¢çŸ¥è¯†åº“åç§°æˆ–æè¿°...",className:"pl-10 h-11 text-base"})]})})})}function F({knowledge:s,onClick:t}){const r=e.jsxs(e.Fragment,{children:[e.jsx(P,{className:"pb-3",children:e.jsx("div",{className:"flex items-start justify-between gap-2",children:e.jsxs("div",{className:"flex items-start gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"text-4xl shrink-0",children:T[s.icon]||"ðŸ“š"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(B,{className:"text-base font-semibold mb-1 line-clamp-2",children:s.name}),e.jsx(z,{className:"text-xs line-clamp-2",children:s.description||"æš‚æ— æè¿°"})]})]})})}),e.jsxs(b,{className:"pt-0",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[e.jsxs("div",{className:"bg-background/50 rounded-lg p-2",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"æ–‡æ¡£æ•°"}),e.jsx("div",{className:"font-semibold text-sm",children:s.document_size})]}),e.jsxs("div",{className:"bg-background/50 rounded-lg p-2",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"æ€»å­—æ•°"}),e.jsx("div",{className:"font-semibold text-sm",children:p(s.word_num)})]}),e.jsxs("div",{className:"bg-background/50 rounded-lg p-2",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"åˆ†è¯æ•°"}),e.jsx("div",{className:"font-semibold text-sm",children:p(s.length)})]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[e.jsxs(f,{variant:"outline",className:"text-xs",children:["ID: ",s.id.slice(0,8),"..."]}),e.jsxs(f,{variant:"secondary",className:"text-xs",children:["å‘é‡æ¨¡åž‹ #",s.embedding_id]})]})]})]});return e.jsx(j,{to:`/knowledge/${s.id}`,children:e.jsx(g,{className:L("group hover:border-primary/50 transition-all hover:shadow-lg cursor-pointer border-2",_[s.background]||"bg-muted/30"),onClick:t,children:r})})}function H({loading:s,knowledgeList:t,searchQuery:r,onKnowledgeClick:n}){return s?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[e.jsx(D,{className:"h-8 w-8 animate-spin text-primary mb-4"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"åŠ è½½ä¸­..."})]}):t.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[e.jsx(m,{className:"h-16 w-16 text-muted-foreground/50 mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"æš‚æ— çŸ¥è¯†åº“"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:r?"æœªæ‰¾åˆ°åŒ¹é…çš„çŸ¥è¯†åº“":"æ‚¨è¿˜æ²¡æœ‰åˆ›å»ºçŸ¥è¯†åº“"})]}):e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4",children:t.map(a=>e.jsx(F,{knowledge:a,onClick:()=>n(a)},a.id))})}function M(){const[s,t]=i.useState([]),[r,n]=i.useState(!0),[a,N]=i.useState(""),[o,v]=i.useState(1),[x,w]=i.useState(0),[O,y]=i.useState(null),{toast:u}=K(),C=async(c=1)=>{try{n(!0);const d=await fetch(`/api/knowledge?page=${c}&size=10`),l=await d.json();d.ok&&l.code===200?(t(l.data.list||[]),w(l.data.total||0),console.log("âœ… æˆåŠŸèŽ·å–çŸ¥è¯†åº“åˆ—è¡¨:",l.data)):u({title:"èŽ·å–å¤±è´¥",description:l.message||"èŽ·å–çŸ¥è¯†åº“åˆ—è¡¨å¤±è´¥",variant:"destructive"})}catch(d){console.error("èŽ·å–çŸ¥è¯†åº“åˆ—è¡¨é”™è¯¯:",d),u({title:"è¯·æ±‚é”™è¯¯",description:"ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åŽé‡è¯•",variant:"destructive"})}finally{n(!1)}};i.useEffect(()=>{C(o)},[o]);const h=s.filter(c=>c.name.toLowerCase().includes(a.toLowerCase())||c.description.toLowerCase().includes(a.toLowerCase()));return e.jsxs("div",{className:"flex h-screen bg-background",children:[e.jsx(R,{total:x,currentCount:h.length}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx($,{searchQuery:a,onSearchChange:N}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:e.jsx(H,{loading:r,knowledgeList:h,searchQuery:a,onKnowledgeClick:y})}),!r&&e.jsx(A,{currentPage:o,total:x,pageSize:10,onPageChange:v})]})]})}function ne(){return e.jsx(Q,{children:e.jsx(M,{})})}export{ne as component};
