import{c as $,j as e,X as c,d as M,u as _,r as n,L as g}from"./main-DK-6tAy6.js";import{B as U}from"./button-CkY6mUU2.js";import{C as z,a as A,b as B,d as D,I as h,e as O}from"./input-DIUOMSeW.js";import{L as p}from"./label-DLI6lelt.js";import{u as G}from"./useAuth-Dd5vIfQw.js";import{P as H}from"./progress-C97f4Luc.js";import{C as d}from"./check-CJQR7mE4.js";import{U as T}from"./user-D1E1GTT_.js";import{M as Z}from"./mail-h5u8iRLy.js";import{L as N,E as P}from"./lock-CNPfPsBD.js";import{E as C}from"./eye-C6Zb2VdP.js";import"./index-CGGIeoMh.js";const q=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],J=$("user-plus",q);function K(l){const r={length:l.length>=8,lowercase:/[a-z]/.test(l),uppercase:/[A-Z]/.test(l),number:/[0-9]/.test(l),special:/[^a-zA-Z0-9]/.test(l)};let s=0;r.length&&(s+=20),r.lowercase&&(s+=20),r.uppercase&&(s+=20),r.number&&(s+=20),r.special&&(s+=20);let a="弱";return s>=80?a="强":s>=60?a="中":s>=40&&(a="一般"),{score:s,label:a,checks:r}}const W="pending_login";function X(l,r){const s={email:l,password:r,timestamp:Date.now()};localStorage.setItem(W,JSON.stringify(s))}function Y({password:l,score:r,label:s,checks:a}){return l?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-gray-600",children:"密码强度:"}),e.jsx("span",{className:`font-medium ${r<=40?"text-red-500":r<=60?"text-yellow-500":r<=80?"text-blue-500":"text-green-500"}`,children:s})]}),e.jsx(H,{value:r,className:"h-1.5 bg-gray-200"}),e.jsxs("div",{className:"flex flex-wrap gap-x-4 gap-y-1 text-xs",children:[e.jsxs("div",{className:`flex items-center gap-1 ${a?.length?"text-green-500":"text-gray-400"}`,children:[a?.length?e.jsx(d,{className:"w-3 h-3"}):e.jsx(c,{className:"w-3 h-3"}),e.jsx("span",{children:"至少8个字符"})]}),e.jsxs("div",{className:`flex items-center gap-1 ${a?.uppercase?"text-green-500":"text-gray-400"}`,children:[a?.uppercase?e.jsx(d,{className:"w-3 h-3"}):e.jsx(c,{className:"w-3 h-3"}),e.jsx("span",{children:"包含大写字母"})]}),e.jsxs("div",{className:`flex items-center gap-1 ${a?.number?"text-green-500":"text-gray-400"}`,children:[a?.number?e.jsx(d,{className:"w-3 h-3"}):e.jsx(c,{className:"w-3 h-3"}),e.jsx("span",{children:"包含数字"})]}),e.jsxs("div",{className:`flex items-center gap-1 ${a?.special?"text-green-500":"text-gray-400"}`,children:[a?.special?e.jsx(d,{className:"w-3 h-3"}):e.jsx(c,{className:"w-3 h-3"}),e.jsx("span",{children:"包含特殊字符"})]})]})]}):null}function Q(){const l=M(),{signUp:r}=G(),{toast:s}=_(),a=n.useId(),I=n.useId(),L=n.useId(),k=n.useId(),[b,y]=n.useState(!1),[f,S]=n.useState(!1),[j,F]=n.useState(!1),[t,m]=n.useState({username:"",email:"",password:"",confirmPassword:""}),x=n.useMemo(()=>K(t.password),[t.password]),R=async i=>{i.preventDefault();const w=t.username.trim(),u=t.email.trim(),o=t.password.trim(),E=t.confirmPassword.trim();if(!w){s({title:"请输入用户名",description:"用户名不能为空",variant:"destructive"});return}if(w.length<2){s({title:"用户名太短",description:"用户名至少需要2个字符",variant:"destructive"});return}if(!u){s({title:"请输入邮箱",description:"邮箱地址不能为空",variant:"destructive"});return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(u)){s({title:"邮箱格式错误",description:"请输入有效的邮箱地址",variant:"destructive"});return}if(!o){s({title:"请输入密码",description:"密码不能为空",variant:"destructive"});return}if(o.length<6){s({title:"密码太短",description:"密码至少需要6个字符",variant:"destructive"});return}if(x.score<40){s({title:"密码强度不足",description:"请使用更强的密码(建议包含大小写字母、数字和特殊字符)",variant:"destructive"});return}if(o!==E){s({title:"密码不匹配",description:"请确保两次输入的密码相同",variant:"destructive"});return}y(!0);try{const{error:v}=await r(u,o,w);v||(X(u,o),l.navigate({to:"/auth/login"}))}catch(v){console.error("注册错误:",v),s({title:"注册失败",description:"发生未知错误,请稍后再试",variant:"destructive"})}finally{y(!1)}};return e.jsxs(z,{className:"border-white/40 shadow-2xl backdrop-blur-xl bg-white/95 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/30 to-gray-50/30 pointer-events-none"}),e.jsxs(A,{className:"relative",children:[e.jsxs(g,{to:"/",className:"inline-flex items-center gap-2 text-gray-600 hover:text-gray-800 mb-4 transition-colors group",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5 transition-transform group-hover:-translate-x-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:[e.jsx("title",{children:"返回箭头"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})]}),e.jsx("span",{className:"font-medium",children:"返回主页"})]}),e.jsx(B,{className:"text-2xl text-center text-gray-800",children:"注册账号"})]}),e.jsxs("form",{onSubmit:R,children:[e.jsxs(D,{className:"space-y-4 relative",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"register-username",className:"text-gray-700",children:"用户名"}),e.jsxs("div",{className:"relative",children:[e.jsx(T,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-blue-600"}),e.jsx(h,{id:a,type:"text",placeholder:"选择一个用户名",value:t.username,onChange:i=>m({...t,username:i.target.value}),className:"pl-10 bg-white/80 border-gray-300 text-gray-900 placeholder:text-gray-500 focus:border-blue-600 focus:ring-blue-600/20 transition-all"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"register-email",className:"text-gray-700",children:"邮箱地址"}),e.jsxs("div",{className:"relative",children:[e.jsx(Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-blue-600"}),e.jsx(h,{id:I,type:"email",placeholder:"your@email.com",value:t.email,onChange:i=>m({...t,email:i.target.value}),className:"pl-10 bg-white/80 border-gray-300 text-gray-900 placeholder:text-gray-500 focus:border-blue-600 focus:ring-blue-600/20 transition-all"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"register-password",className:"text-gray-700",children:"密码"}),e.jsxs("div",{className:"relative",children:[e.jsx(N,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-blue-600"}),e.jsx(h,{id:L,type:f?"text":"password",placeholder:"至少6个字符",value:t.password,onChange:i=>m({...t,password:i.target.value}),className:"pl-10 pr-10 bg-white/80 border-gray-300 text-gray-900 placeholder:text-gray-500 focus:border-blue-600 focus:ring-blue-600/20 transition-all"}),e.jsx("button",{type:"button",onClick:()=>S(!f),className:"absolute right-3 top-1/2 -translate-y-1/2 text-blue-600 hover:text-blue-800 transition-colors",children:f?e.jsx(P,{className:"w-4 h-4"}):e.jsx(C,{className:"w-4 h-4"})})]}),e.jsx(Y,{password:t.password,score:x.score,label:x.label,checks:x.checks})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"register-confirm-password",className:"text-gray-700",children:"确认密码"}),e.jsxs("div",{className:"relative",children:[e.jsx(N,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-blue-600"}),e.jsx(h,{id:k,type:j?"text":"password",placeholder:"再次输入密码",value:t.confirmPassword,onChange:i=>m({...t,confirmPassword:i.target.value}),className:"pl-10 pr-10 bg-white/80 border-gray-300 text-gray-900 placeholder:text-gray-500 focus:border-blue-600 focus:ring-blue-600/20 transition-all"}),e.jsx("button",{type:"button",onClick:()=>F(!j),className:"absolute right-3 top-1/2 -translate-y-1/2 text-blue-600 hover:text-blue-800 transition-colors",children:j?e.jsx(P,{className:"w-4 h-4"}):e.jsx(C,{className:"w-4 h-4"})})]}),t.confirmPassword&&t.password!==t.confirmPassword&&e.jsxs("p",{className:"text-xs text-red-500 flex items-center gap-1",children:[e.jsx(c,{className:"w-3 h-3"}),"密码不匹配"]}),t.confirmPassword&&t.password===t.confirmPassword&&e.jsxs("p",{className:"text-xs text-green-500 flex items-center gap-1",children:[e.jsx(d,{className:"w-3 h-3"}),"密码匹配"]})]})]}),e.jsxs(O,{className:"flex flex-col gap-4 relative",children:[e.jsx(U,{type:"submit",className:"w-full bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700 text-white font-medium shadow-lg shadow-blue-600/30 transition-all transform hover:scale-[1.02] active:scale-[0.98]",disabled:b,children:b?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin mr-2"}),"注册中..."]}):e.jsxs(e.Fragment,{children:[e.jsx(J,{className:"w-4 h-4 mr-2"}),"注册"]})}),e.jsxs("p",{className:"text-sm text-center text-gray-600",children:["已有账号?"," ",e.jsx(g,{to:"/auth/login",className:"text-blue-600 hover:text-blue-700 hover:underline font-medium transition-colors",children:"立即登录"})]})]})]})]})}function V(){return e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4 bg-gray-50",children:e.jsxs("div",{className:"w-full max-w-md relative z-10",children:[e.jsx("div",{className:"text-center mb-8",children:e.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-blue-600 via-cyan-600 to-sky-600 bg-clip-text text-transparent",children:"库无忧助手"})}),e.jsx(Q,{}),e.jsxs("p",{className:"text-center text-xs text-gray-500 mt-6",children:["继续即表示您同意我们的"," ",e.jsx(g,{to:"/terms",className:"text-blue-600 hover:text-blue-700 hover:underline transition-colors",children:"服务条款"})," ","和"," ",e.jsx(g,{to:"/privacy",className:"text-blue-600 hover:text-blue-700 hover:underline transition-colors",children:"隐私政策"})]})]})})}function ue(){return e.jsx(V,{})}export{ue as component};
