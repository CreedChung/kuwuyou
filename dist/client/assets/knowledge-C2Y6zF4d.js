import{j as e,L as p,a as k,r as i,d as S}from"./main--f0sO-hz.js";import{B as m}from"./button-BNUdYx8Q.js";import{C as j,d as N,I as K,a as B,b as P,c as z}from"./index-CrzuKdR7.js";import{A as E}from"./arrow-left-CIBegNe1.js";import{B as x}from"./book-open-Gz0h7x50.js";import{S as I}from"./react-icons.esm-DE5O5_Xe.js";import{B as f}from"./badge-CHSACegF.js";import{L as T,P as _}from"./ProtectedRoute-CTX_1QGf.js";import"./label-BFd5GmZs.js";import"./progress-BWGakowv.js";import"./index-CtyBIE80.js";import"./index-BPOU2SOy.js";const $={blue:"bg-blue-500/10 border-blue-500/20",green:"bg-green-500/10 border-green-500/20",purple:"bg-purple-500/10 border-purple-500/20",orange:"bg-orange-500/10 border-orange-500/20",red:"bg-red-500/10 border-red-500/20",yellow:"bg-yellow-500/10 border-yellow-500/20",pink:"bg-pink-500/10 border-pink-500/20",indigo:"bg-indigo-500/10 border-indigo-500/20"},A={book:"ðŸ“š",file:"ðŸ“„",folder:"ðŸ“",star:"â­",heart:"â¤ï¸",rocket:"ðŸš€",bulb:"ðŸ’¡",flag:"ðŸš©"},g=s=>s>=1e4?`${(s/1e4).toFixed(1)}ä¸‡`:s.toLocaleString();function D({total:s,currentCount:r}){return e.jsxs("div",{className:"w-64 border-r border-border/40 bg-muted/30 flex flex-col",children:[e.jsx("div",{className:"p-4 border-b border-border/40",children:e.jsx(p,{href:"/chat",children:e.jsxs(m,{variant:"ghost",size:"sm",className:"w-full justify-start gap-2 hover:bg-muted",children:[e.jsx(E,{className:"h-4 w-4"}),e.jsx("span",{children:"è¿”å›ž"})]})})}),e.jsx("div",{className:"px-4 py-6",children:e.jsxs("h1",{className:"text-xl font-semibold flex items-center gap-2",children:[e.jsx(x,{className:"h-5 w-5"}),"çŸ¥è¯†åº“"]})}),e.jsx("div",{className:"px-4 pb-4",children:e.jsx(j,{className:"bg-gradient-to-br from-primary/10 via-primary/5 to-transparent border-primary/20 shadow-sm",children:e.jsx(N,{className:"p-5",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"çŸ¥è¯†åº“æ€»æ•°"}),e.jsx("p",{className:"text-3xl font-bold text-foreground",children:s})]}),e.jsx("div",{className:"h-12 w-12 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(x,{className:"h-6 w-6 text-primary"})})]}),e.jsx("div",{className:"pt-3 border-t border-border/50",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"å½“å‰æ˜¾ç¤º"}),e.jsx("span",{className:"font-semibold text-lg text-foreground",children:r})]})})]})})})}),e.jsx("div",{className:"flex-1 px-4 pb-4"})]})}function F({searchQuery:s,onSearchChange:r}){return e.jsx("div",{className:"border-b border-border/40 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"relative max-w-2xl",children:[e.jsx(I,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(K,{value:s,onChange:t=>r(t.target.value),placeholder:"æœç´¢çŸ¥è¯†åº“åç§°æˆ–æè¿°...",className:"pl-10 h-11 text-base"})]})})})}function M({knowledge:s,onClick:r}){const t=e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"pb-3",children:e.jsx("div",{className:"flex items-start justify-between gap-2",children:e.jsxs("div",{className:"flex items-start gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"text-4xl shrink-0",children:A[s.icon]||"ðŸ“š"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(P,{className:"text-base font-semibold mb-1 line-clamp-2",children:s.name}),e.jsx(z,{className:"text-xs line-clamp-2",children:s.description||"æš‚æ— æè¿°"})]})]})})}),e.jsxs(N,{className:"pt-0",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[e.jsxs("div",{className:"bg-background/50 rounded-lg p-2",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"æ–‡æ¡£æ•°"}),e.jsx("div",{className:"font-semibold text-sm",children:s.document_size})]}),e.jsxs("div",{className:"bg-background/50 rounded-lg p-2",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"æ€»å­—æ•°"}),e.jsx("div",{className:"font-semibold text-sm",children:g(s.word_num)})]}),e.jsxs("div",{className:"bg-background/50 rounded-lg p-2",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"åˆ†è¯æ•°"}),e.jsx("div",{className:"font-semibold text-sm",children:g(s.length)})]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[e.jsxs(f,{variant:"outline",className:"text-xs",children:["ID: ",s.id.slice(0,8),"..."]}),e.jsxs(f,{variant:"secondary",className:"text-xs",children:["å‘é‡æ¨¡åž‹ #",s.embedding_id]})]})]})]});return e.jsx(p,{to:`/knowledge/${s.id}`,children:e.jsx(j,{className:k("group hover:border-primary/50 transition-all hover:shadow-lg cursor-pointer border-2",$[s.background]||"bg-muted/30"),onClick:r,children:t})})}function Q({loading:s,knowledgeList:r,searchQuery:t,onKnowledgeClick:l}){return s?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[e.jsx(T,{className:"h-8 w-8 animate-spin text-primary mb-4"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"åŠ è½½ä¸­..."})]}):r.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[e.jsx(x,{className:"h-16 w-16 text-muted-foreground/50 mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"æš‚æ— çŸ¥è¯†åº“"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:t?"æœªæ‰¾åˆ°åŒ¹é…çš„çŸ¥è¯†åº“":"æ‚¨è¿˜æ²¡æœ‰åˆ›å»ºçŸ¥è¯†åº“"})]}):e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4",children:r.map(a=>e.jsx(M,{knowledge:a,onClick:()=>l(a)},a.id))})}function R({currentPage:s,total:r,pageSize:t=10,onPageChange:l}){const a=Math.ceil(r/t);return r<=t?null:e.jsx("div",{className:"border-t border-border/40 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(m,{variant:"outline",disabled:s===1,onClick:()=>l(s-1),children:"ä¸Šä¸€é¡µ"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["ç¬¬ ",s," é¡µ / å…± ",a," é¡µ"]}),e.jsx(m,{variant:"outline",disabled:s>=a,onClick:()=>l(s+1),children:"ä¸‹ä¸€é¡µ"})]})})}function H(){const[s,r]=i.useState([]),[t,l]=i.useState(!0),[a,v]=i.useState(""),[c,w]=i.useState(1),[u,y]=i.useState(0),[O,C]=i.useState(null),{toast:h}=S(),L=async(d=1)=>{try{l(!0);const o=await fetch(`/api/knowledge?page=${d}&size=10`),n=await o.json();o.ok&&n.code===200?(r(n.data.list||[]),y(n.data.total||0),console.log("âœ… æˆåŠŸèŽ·å–çŸ¥è¯†åº“åˆ—è¡¨:",n.data)):h({title:"èŽ·å–å¤±è´¥",description:n.message||"èŽ·å–çŸ¥è¯†åº“åˆ—è¡¨å¤±è´¥",variant:"destructive"})}catch(o){console.error("èŽ·å–çŸ¥è¯†åº“åˆ—è¡¨é”™è¯¯:",o),h({title:"è¯·æ±‚é”™è¯¯",description:"ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åŽé‡è¯•",variant:"destructive"})}finally{l(!1)}};i.useEffect(()=>{L(c)},[c]);const b=s.filter(d=>d.name.toLowerCase().includes(a.toLowerCase())||d.description.toLowerCase().includes(a.toLowerCase()));return e.jsxs("div",{className:"flex h-screen bg-background",children:[e.jsx(D,{total:u,currentCount:b.length}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx(F,{searchQuery:a,onSearchChange:v}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:e.jsx(Q,{loading:t,knowledgeList:b,searchQuery:a,onKnowledgeClick:C})}),!t&&e.jsx(R,{currentPage:c,total:u,pageSize:10,onPageChange:w})]})]})}function te(){return e.jsx(_,{children:e.jsx(H,{})})}export{te as component};
